
<html>

<head>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="input_form_style.css">
</head>

<body onload="generatePage()">

<script type="text/javascript" src="mesh_specs.json"></script>
<script type="text/javascript" src="formGeneration.js"></script>
<script type="text/javascript" src="mesh_config_files\\plane.json"></script>


<script type="text/javascript">
	
	var gridTileCollections = {};
	gridTileCollections["all"] = [];
	gridTileCollections["2D"] = [];
	gridTileCollections["3D"] = [];
	gridTileCollections["primitive"] = [];
	gridTileCollections["beam"] = [];
	gridTileCollections["connection"] = [];
	
	
	/*
		Create filter checkboxes from categories in mesh_specs.json
	*/
	function createFilterCheckBoxes(){
		const categories = meshSpecs["categories"];		
		categories.forEach(function(item, index){
			const mainAreaEl = document.getElementById("filter-checkboxes");
			
			const div = document.createElement("div");
			const label = document.createElement("label");
			const checkbox = document.createElement("input");
			const id = "filter-" + item + "-cb";
			label.for 		= id;
			label.innerHTML = item;
			checkbox.type = "checkbox"
			checkbox.id = id;
			checkbox.value = item;
			checkbox.checked = true;			
			checkbox.setAttribute("onchange","filterCheckBoxAction(this)");
			
			div.className = "filterTile";
			div.appendChild(label);
			div.appendChild(checkbox);		
			mainAreaEl.appendChild(div);
		});
		
	}
	
	/*
	Sets the state of tiles of category == category to display state == state.
	Hides or displays the requested tile types.
	*/
	function gridFilter(category, state){
		const tileArr = gridTileCollections[category];
		if(tileArr.length !== 0){
			for(const el of tileArr){
				el.style.display = state;		
			}
		}
	}
	
	/*
		Called by filter checkboxes.
		Unchecked -> hide tiles
		Checked   -> show tiles
	*/
	function filterCheckBoxAction(cbel){	
		if(cbel.checked){
			gridFilter(cbel.value, "grid");
		}
		else{
			gridFilter(cbel.value, "none");
		}
	}	
	
	/*
		Called by onclick event of Show all button
		Sets all checkboxes to checked and display all grid elements
	*/
	function filterShowAll(){
		const children = document.getElementById("filter-checkboxes").getElementsByTagName("input");		
		for (var i = 0; i < children.length; i++) {			
			if(children[i].type == "checkbox"){
				children[i].checked = true;
			}
		}
		gridFilter("all", "grid");
	}

	/*
		Read mesh_specs.JSON and initialized the tiles of the different meshers.
		Tiles references are collected in gridTileCollections map.
	*/
	function loadMeshGridsFromJSON(){
		var meshers = meshSpecs["meshers"];		
		var sectionElement = document.getElementById("mesh_grid_section");

		meshers.forEach(function(item, index){
			
			const tile 		= document.createElement("div");
			const tileName	= document.createElement("h4");
			const tileLink	= document.createElement("a");			
			const tileImg	= document.createElement("img");		
			const tileDescr	= document.createElement("h5");
			
			const name 	 = item.name;
			const img 	 = item.img;
			const descr  = item.description;
			const config = item.config;
			
			tile.className = "meshersTile";
			
			const categories = item.categories;
			categories.forEach(function(item,index){
				tile.className += (" " + item);
				
				gridTileCollections[item].push(tile);
				gridTileCollections["all"].push(tile);
			});
			
			
			//tileDescr.className = "description";
			
			tile.appendChild(tileName);
			tile.appendChild(tileLink);
			tile.appendChild(tileDescr);				
				
			tileLink.appendChild(tileImg);
			
			tileImg.src 		= img;
			tileName.innerHTML 	= name;
			tileDescr.innerHTML = descr;
			
			tileLink.href = "#";
			tileLink.setAttribute("onclick", "javascript:showMeshGeneratorWindow(this)");
			tileLink.id = config;
			
			sectionElement.appendChild(tile);
		});
		
	}

	/*
		Main onload function of body
	*/
	function generatePage(){
		loadMeshGridsFromJSON();
		createFilterCheckBoxes();
	}
	
	/*
		Generates and displays the mesh generator input window
	*/
	function showMeshGeneratorWindow(element){
		//gridFilter("all", "none");
		
		const sectionElement = document.getElementById("mesh_grid_section");
		sectionElement.display = "none";
		gridFilter("all", "none");
	
		const tile	 	 = document.createElement("div");
		const tileHeader = document.createElement("h4");	
		const tileHeader2 = document.createElement("h3");			
		const section 	 = document.createElement("section");		
		
		tile.className = "meshGeneratorWindow";
		
		tile.appendChild(tileHeader);
		tile.appendChild(tileHeader2);
		tile.appendChild(section);
		
		tileHeader.innerHTML = "Mesh generator";
		tileHeader2.innerHTML = "<a href=#>Exit</a>";
		
		const mainArea = document.getElementById("main_area");
		mainArea.appendChild(tile);		
		
		const configVarName = element.id;
		const configData    = window[configVarName];
		generateMeshGeneratorWindowContent(configData, section)
	}
	
	function generateMeshGeneratorWindowContent(configData, section){

		const descriptionTitle = document.createElement("h2");
		descriptionTitle.innerHTML = "Description";
		section.appendChild(descriptionTitle);

		
		const description = configData["description"];
		description.forEach(function(item, index){
			var paragraphElement = document.createElement("p");
			paragraphElement.innerHTML = item;
			section.appendChild(paragraphElement);
		});
		
		
		const inputTitle = document.createElement("h2");
		inputTitle.innerHTML = "Input form";
		section.appendChild(inputTitle);
		
		const theForm = document.createElement("form");
		theForm.className = "inputForm";
		section.appendChild(theForm);
				
		const inputs = configData["input"];
		inputs.forEach(function(item, index){
			var isIntSlider = item.type === "slider_integer";			
			createSlider(item.name, theForm, item.range[0], item.range[1], item.default, item.range[2], isIntSlider);			
		});
	
	}
	
</script>


<div class="wrapper">
        <header class="main-head">The header</header>
       
	   <nav class="main-nav">
            <ul>
                <li><a href="">Nav 1</a></li>
                <li><a href="">Nav 2</a></li>
            </ul>
        </nav>

        <article class="content" id="main_area">
            <h1>Browse mesh generators</h1>
            <p>In this layout, we display the areas in source order for any screen less that 500 pixels wide. We go to a two column layout, and then to a three column layout by redefining the grid, and the placement of items on the grid.</p>
			
			<div id="filter-checkboxes" class="filterGrid">			
				<input type="button" Value="Show all" id="filter-all-btn" onclick="filterShowAll()">
			</div>
			<br><br><br>
			
			<section class="meshersGrid" id="mesh_grid_section"></section>
			
			
        </article>

        <aside class="side">Sidebar</aside>
        <div class="ad">Advertising</div>
        <footer class="main-footer">The footer</footer>
</div>



</body>


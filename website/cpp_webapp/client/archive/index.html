<!DOCTYPE html>
<html>
	<head>
		<link rel="stylesheet" href="styles.css">
	</head>
<body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
 
<h1>Mesh generator</h1>
<form id="search-form" method="post">
	Input field 1:
	<input type="text" name="input1" id="input1" value = "10"><br>
	Input field 2:
	<input type="text" name="input2" id="input2" value = "test"><br>
	Input field 3:
	<input type="text" name="input3" id="input3" value = "out.txt"><br>	
	Input field 4:
	<input type="text" name="input4" id="input4" value = ""><br>
	Input field 5:
	<input type="text" name="input5" id="input5" value = ""><br>
	
	<input type="submit" value = "Generate"><br>
	
</form>

<div id="loader" style="display: none;">
	<img src='media/reload.gif' width='32px' height='32px'>
</div>

<script type="text/javascript">
		const $form = $('#search-form')

		$form.on('submit', submitHandler)

		function submitHandler (e) {
		  e.preventDefault()

		  $.ajax({
			url: '/generate',
			type:'POST',
			method: 'POST',
			data: $form.serialize(),
			beforeSend: function(){
				document.getElementById("loader").style.display = "block";
			},
			complete: function(data){
				document.getElementById("loader").style.display = "none";
			}
			//timeout: 600000
		  }).done(response => {
			console.log(response);
			//document.location.assign(response);
			
			var a = document.createElement('a');
			a.href = response;
			// Give filename you wish to download
			a.download = document.getElementById("input3").value;
			a.style.display = 'none';
			document.body.appendChild(a);
			a.click();
		  })

		}		
</script>


</body>
</html>